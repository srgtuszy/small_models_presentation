{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "‚ñ∂ Demo 1: Train Tiny Transformer",
            "type": "shell",
            "command": "python3",
            "args": ["tiny_transformer_train.py"],
            "options": { "cwd": "${workspaceFolder}/demo1_tiny_transformer" },
            "group": "build",
            "detail": "Run the Python training script (2-3 min)",
            "presentation": { "reveal": "always", "panel": "new", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 1: Android Build",
            "type": "shell",
            "command": "./gradlew",
            "args": [":composeApp:assembleDebug"],
            "options": { "cwd": "${workspaceFolder}/demo1_tiny_transformer/mobile-app" },
            "group": "build",
            "detail": "Build Android APK",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 1: Android Install",
            "type": "shell",
            "command": "./gradlew",
            "args": [":composeApp:installDebug"],
            "options": { "cwd": "${workspaceFolder}/demo1_tiny_transformer/mobile-app" },
            "group": "build",
            "detail": "Install on connected Android device",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 1: Android (Full)",
            "dependsOn": ["‚ñ∂ Demo 1: Android Build", "‚ñ∂ Demo 1: Android Install"],
            "dependsOrder": "sequence",
            "group": { "kind": "build", "isDefault": false },
            "detail": "Build and install app on connected device",
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 1: iOS Generate Project",
            "type": "shell",
            "command": "xcodegen",
            "args": ["generate"],
            "options": { "cwd": "${workspaceFolder}/demo1_tiny_transformer/mobile-app/iosApp" },
            "group": "build",
            "detail": "Generate Xcode project from project.yml",
            "presentation": { "reveal": "silent" }
        },
        {
            "label": "‚ñ∂ Demo 1: iOS Build Framework",
            "type": "shell",
            "command": "./gradlew",
            "args": [":composeApp:linkDebugFrameworkIosSimulatorArm64"],
            "options": { "cwd": "${workspaceFolder}/demo1_tiny_transformer/mobile-app" },
            "group": "build",
            "detail": "Build Shared.framework for simulator only (fast)",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 1: iOS Build App",
            "type": "shell",
            "command": "xcodebuild",
            "args": [
                "-project", "iosApp.xcodeproj",
                "-scheme", "iosApp",
                "-destination", "platform=iOS Simulator,id=24BF1FED-6B05-479D-88B1-3E48AB3291B7",
                "-configuration", "Debug",
                "SYMROOT=build",
                "build"
            ],
            "options": { "cwd": "${workspaceFolder}/demo1_tiny_transformer/mobile-app/iosApp" },
            "group": "build",
            "detail": "Build iOS app for simulator",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 1: iOS (Full)",
            "dependsOn": [
                "üçé Ensure iOS Simulator",
                "‚ñ∂ Demo 1: iOS Generate Project",
                "‚ñ∂ Demo 1: iOS Build Framework",
                "‚ñ∂ Demo 1: iOS Build App"
            ],
            "dependsOrder": "sequence",
            "group": "build",
            "detail": "Boot simulator, generate project, build framework, build app",
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 1: iOS Launch",
            "dependsOn": ["‚ñ∂ Demo 1: iOS (Full)"],
            "type": "shell",
            "command": "xcrun",
            "args": [
                "simctl", "install", "booted", 
                "${workspaceFolder}/demo1_tiny_transformer/mobile-app/iosApp/build/Debug-iphonesimulator/iosApp.app",
                "&&", "xcrun", "simctl", "launch", "booted", "org.example.iosApp"
            ],
            "group": "build",
            "detail": "Install and launch iOS app on simulator",
            "presentation": { "reveal": "silent" },
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: Desktop",
            "type": "shell",
            "command": "./gradlew",
            "args": ["run"],
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma" },
            "group": "build",
            "detail": "Launch Function Gemma demo on desktop",
            "presentation": { "reveal": "always", "panel": "new", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 2: Download Model",
            "type": "shell",
            "command": "./download_model.sh",
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma" },
            "group": "build",
            "detail": "Download FunctionGemma GGUF model for llama.cpp",
            "presentation": { "reveal": "always", "clear": true },
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: Android Build",
            "type": "shell",
            "command": "./gradlew",
            "args": [":composeApp:assembleDebug"],
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma" },
            "group": "build",
            "detail": "Build Android APK with llama.cpp via Llamatik",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 2: Android Install",
            "type": "shell",
            "command": "./gradlew",
            "args": [":composeApp:installDebug"],
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma" },
            "group": "build",
            "detail": "Install on connected Android device",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 2: Android (Full)",
            "dependsOn": ["‚ñ∂ Demo 2: Android Build", "‚ñ∂ Demo 2: Android Install"],
            "dependsOrder": "sequence",
            "group": { "kind": "build", "isDefault": false },
            "detail": "Build and install app on connected device",
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: iOS Generate Project",
            "type": "shell",
            "command": "xcodegen",
            "args": ["generate"],
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma/iosApp" },
            "group": "build",
            "detail": "Generate Xcode project from project.yml",
            "presentation": { "reveal": "silent" }
        },
        {
            "label": "‚ñ∂ Demo 2: iOS Build Framework",
            "type": "shell",
            "command": "./gradlew",
            "args": [":composeApp:linkDebugFrameworkIosSimulatorArm64"],
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma" },
            "group": "build",
            "detail": "Build Shared.framework for simulator only (fast)",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "‚ñ∂ Demo 2: iOS Build App",
            "type": "shell",
            "command": "xcodebuild",
            "args": [
                "-project", "iosApp.xcodeproj",
                "-scheme", "iosApp",
                "-destination", "platform=iOS Simulator,id=24BF1FED-6B05-479D-88B1-3E48AB3291B7",
                "-configuration", "Debug",
                "SYMROOT=build",
                "build"
            ],
            "options": { "cwd": "${workspaceFolder}/demo2_function_gemma/iosApp" },
            "group": "build",
            "detail": "Build iOS app for simulator",
            "presentation": { "reveal": "always", "clear": true }
        },
        {
            "label": "üçé Ensure iOS Simulator",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/ensure-ios-simulator.sh",
            "group": "build",
            "detail": "Boot iOS simulator if not running",
            "presentation": { "reveal": "always" },
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: iOS Kill App",
            "type": "shell",
            "command": "xcrun",
            "args": ["simctl", "terminate", "booted", "demo.functiongemma"],
            "group": "build",
            "detail": "Kill any running instance of the app",
            "presentation": { "reveal": "silent" },
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: iOS (Full)",
            "dependsOn": [
                "üçé Ensure iOS Simulator",
                "‚ñ∂ Demo 2: iOS Generate Project",
                "‚ñ∂ Demo 2: iOS Build Framework",
                "‚ñ∂ Demo 2: iOS Build App"
            ],
            "dependsOrder": "sequence",
            "group": "build",
            "detail": "Boot simulator, generate project, build framework, build app",
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: iOS Kill & Build",
            "dependsOn": [
                "‚ñ∂ Demo 2: iOS Kill App",
                "‚ñ∂ Demo 2: iOS (Full)"
            ],
            "dependsOrder": "sequence",
            "group": "build",
            "detail": "Kill app, then build",
            "problemMatcher": []
        },
        {
            "label": "‚ñ∂ Demo 2: iOS Launch",
            "dependsOn": ["‚ñ∂ Demo 2: iOS (Full)"],
            "type": "shell",
            "command": "xcrun",
            "args": [
                "simctl", "install", "booted", 
                "${workspaceFolder}/demo2_function_gemma/iosApp/build/Debug-iphonesimulator/iosApp.app",
                "&&", "xcrun", "simctl", "launch", "booted", "demo.functiongemma"
            ],
            "group": "build",
            "detail": "Install and launch iOS app on simulator",
            "presentation": { "reveal": "silent" },
            "problemMatcher": []
        },
        {
            "label": "üìΩ Slides: Start Server",
            "type": "shell",
            "command": "python3",
            "args": ["-m", "http.server", "8000"],
            "options": { "cwd": "${workspaceFolder}/slides" },
            "group": "build",
            "detail": "Start local server for presentation slides",
            "presentation": { "reveal": "always", "panel": "new" }
        }
    ]
}